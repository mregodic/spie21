# 3D U-Net Network and TRE Estimation for Titanium Spherical Fiducials

This repository provides the code and materials described in the paper "Feasibility of automated fiducial registration with a nasopharyngeal stent for electromagnetic navigation" In SPIE Proc. 2021.

TensorFlow and Keras as backend deep learning libraries were used.

The code was inspired by: 
 - [Optimized High Resolution 3D Dense-U-Net Network for Brain and Spine Segmentation](https://github.com/mrkolarik/3D-brain-segmentation).
 - [TRE estimation](https://github.com/mregodic/spie21/TRE_Fitzpatrick.py) by J. Michael Fitzpatrick, J. B. West, and C. R. Maurer, "Predicting error in rigid-body point-based registration," IEEE Trans. Med. Imaging 17(5), pp. 694-702, 1998

The spherical fiducials are provided in CT images (typically 4 fiducials embedded inside the nasopharynx).
 
 ![Alt text](/images/unet.jpg?raw=true)

 